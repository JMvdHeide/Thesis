[2019-12-26 22:04:16,567 INFO]  * src vocab size = 38
[2019-12-26 22:04:16,569 INFO]  * tgt vocab size = 42
[2019-12-26 22:04:16,570 INFO] Building model...
[2019-12-26 22:04:26,032 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(38, 500, padding_idx=1)
        )
      )
    )
    (rnn): LSTM(500, 500, num_layers=2, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(42, 500, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(1000, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=42, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-12-26 22:04:26,033 INFO] encoder: 4027000
[2019-12-26 22:04:26,033 INFO] decoder: 5800042
[2019-12-26 22:04:26,033 INFO] * number of parameters: 9827042
[2019-12-26 22:04:26,039 INFO] Starting training on GPU: [0]
[2019-12-26 22:04:26,040 INFO] Start training loop and validate every 50 steps...
[2019-12-26 22:04:26,040 INFO] Loading dataset from Data/SVO_AN/prepro.train.0.pt
[2019-12-26 22:04:27,612 INFO] number of examples: 128841
[2019-12-26 22:04:30,999 INFO] Step 50/ 1000; acc:  11.41; ppl: 324.45; xent: 5.78; lr: 1.00000; 5162/5807 tok/s;      5 sec
[2019-12-26 22:04:31,000 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-26 22:04:31,553 INFO] number of examples: 16105
[2019-12-26 22:04:36,819 INFO] Validation perplexity: 61.6594
[2019-12-26 22:04:36,819 INFO] Validation accuracy: 19.148
[2019-12-26 22:04:36,820 INFO] Model is improving ppl: inf --> 61.6594.
[2019-12-26 22:04:36,820 INFO] Model is improving acc: -inf --> 19.148.
[2019-12-26 22:04:38,166 INFO] Step 100/ 1000; acc:  15.83; ppl: 93.42; xent: 4.54; lr: 1.00000; 3572/4019 tok/s;     12 sec
[2019-12-26 22:04:38,166 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-26 22:04:38,243 INFO] number of examples: 16105
[2019-12-26 22:04:43,532 INFO] Validation perplexity: 18.271
[2019-12-26 22:04:43,533 INFO] Validation accuracy: 14.1316
[2019-12-26 22:04:43,533 INFO] Stalled patience: 2/3
[2019-12-26 22:04:44,849 INFO] Step 150/ 1000; acc:  30.55; ppl: 11.20; xent: 2.42; lr: 1.00000; 3831/4310 tok/s;     19 sec
[2019-12-26 22:04:44,849 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-26 22:04:45,227 INFO] number of examples: 16105
[2019-12-26 22:04:50,463 INFO] Validation perplexity: 4.55167
[2019-12-26 22:04:50,464 INFO] Validation accuracy: 43.293
[2019-12-26 22:04:50,464 INFO] Model is improving ppl: 61.6594 --> 4.55167.
[2019-12-26 22:04:50,464 INFO] Model is improving acc: 19.148 --> 43.293.
[2019-12-26 22:04:51,819 INFO] Step 200/ 1000; acc:  45.30; ppl:  4.55; xent: 1.52; lr: 1.00000; 3673/4132 tok/s;     26 sec
[2019-12-26 22:04:51,819 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-26 22:04:51,886 INFO] number of examples: 16105
[2019-12-26 22:04:57,084 INFO] Validation perplexity: 6.67544
[2019-12-26 22:04:57,084 INFO] Validation accuracy: 48.635
[2019-12-26 22:04:57,084 INFO] Stalled patience: 2/3
[2019-12-26 22:04:58,469 INFO] Step 250/ 1000; acc:  58.70; ppl:  3.35; xent: 1.21; lr: 1.00000; 3849/4331 tok/s;     32 sec
[2019-12-26 22:04:58,470 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-26 22:04:58,861 INFO] number of examples: 16105
[2019-12-26 22:05:04,443 INFO] Validation perplexity: 2.72583
[2019-12-26 22:05:04,444 INFO] Validation accuracy: 65.5469
[2019-12-26 22:05:04,444 INFO] Model is improving ppl: 4.55167 --> 2.72583.
[2019-12-26 22:05:04,444 INFO] Model is improving acc: 43.293 --> 65.5469.
[2019-12-26 22:05:05,804 INFO] Step 300/ 1000; acc:  91.36; ppl:  1.33; xent: 0.29; lr: 1.00000; 3491/3927 tok/s;     40 sec
[2019-12-26 22:05:05,804 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-26 22:05:05,904 INFO] number of examples: 16105
[2019-12-26 22:05:11,243 INFO] Validation perplexity: 1.0832
[2019-12-26 22:05:11,244 INFO] Validation accuracy: 97.7198
[2019-12-26 22:05:11,244 INFO] Model is improving ppl: 2.72583 --> 1.0832.
[2019-12-26 22:05:11,244 INFO] Model is improving acc: 65.5469 --> 97.7198.
[2019-12-26 22:05:12,600 INFO] Step 350/ 1000; acc:  99.87; ppl:  1.01; xent: 0.01; lr: 1.00000; 3767/4238 tok/s;     47 sec
[2019-12-26 22:05:12,600 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-26 22:05:12,670 INFO] number of examples: 16105
[2019-12-26 22:05:17,907 INFO] Validation perplexity: 1.00064
[2019-12-26 22:05:17,907 INFO] Validation accuracy: 100
[2019-12-26 22:05:17,907 INFO] Model is improving ppl: 1.0832 --> 1.00064.
[2019-12-26 22:05:17,908 INFO] Model is improving acc: 97.7198 --> 100.
[2019-12-26 22:05:19,271 INFO] Step 400/ 1000; acc: 100.00; ppl:  1.00; xent: 0.00; lr: 1.00000; 3838/4317 tok/s;     53 sec
[2019-12-26 22:05:19,271 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-26 22:05:19,647 INFO] number of examples: 16105
[2019-12-26 22:05:25,004 INFO] Validation perplexity: 1.00034
[2019-12-26 22:05:25,004 INFO] Validation accuracy: 100
[2019-12-26 22:05:25,004 INFO] Stalled patience: 2/3
[2019-12-26 22:05:26,371 INFO] Step 450/ 1000; acc: 100.00; ppl:  1.00; xent: 0.00; lr: 1.00000; 3606/4057 tok/s;     60 sec
[2019-12-26 22:05:26,371 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-26 22:05:26,439 INFO] number of examples: 16105
[2019-12-26 22:05:31,834 INFO] Validation perplexity: 1.00022
[2019-12-26 22:05:31,834 INFO] Validation accuracy: 100
[2019-12-26 22:05:31,834 INFO] Stalled patience: 1/3
[2019-12-26 22:05:33,172 INFO] Step 500/ 1000; acc: 100.00; ppl:  1.00; xent: 0.00; lr: 1.00000; 3764/4235 tok/s;     67 sec
[2019-12-26 22:05:33,173 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-26 22:05:33,557 INFO] number of examples: 16105
[2019-12-26 22:05:38,946 INFO] Validation perplexity: 1.00016
[2019-12-26 22:05:38,946 INFO] Validation accuracy: 100
[2019-12-26 22:05:38,946 INFO] Stalled patience: 0/3
[2019-12-26 22:05:38,946 INFO] Training finished after stalled validations. Early Stop!
[2019-12-26 22:05:38,946 INFO] Best model found at step 350
[2019-12-26 22:05:38,957 INFO] Saving checkpoint Models/SVO_AN_model_step_500.pt
