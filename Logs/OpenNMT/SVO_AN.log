[2019-12-22 19:24:23,925 INFO]  * src vocab size = 38
[2019-12-22 19:24:23,927 INFO]  * tgt vocab size = 42
[2019-12-22 19:24:23,927 INFO] Building model...
[2019-12-22 19:24:38,387 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(38, 500, padding_idx=1)
        )
      )
    )
    (rnn): LSTM(500, 500, num_layers=2, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(42, 500, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(1000, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=42, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-12-22 19:24:38,387 INFO] encoder: 4027000
[2019-12-22 19:24:38,387 INFO] decoder: 5800042
[2019-12-22 19:24:38,388 INFO] * number of parameters: 9827042
[2019-12-22 19:24:38,394 INFO] Starting training on GPU: [0]
[2019-12-22 19:24:38,394 INFO] Start training loop and validate every 50 steps...
[2019-12-22 19:24:38,395 INFO] Loading dataset from Data/SVO_AN/prepro.train.0.pt
[2019-12-22 19:24:39,475 INFO] number of examples: 128841
[2019-12-22 19:24:42,111 INFO] Step 50/ 2014; acc:  13.73; ppl: 91.07; xent: 4.51; lr: 1.00000; 6889/7750 tok/s;      4 sec
[2019-12-22 19:24:42,111 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-22 19:24:42,451 INFO] number of examples: 16105
[2019-12-22 19:24:47,302 INFO] Validation perplexity: 20.4038
[2019-12-22 19:24:47,303 INFO] Validation accuracy: 22.1532
[2019-12-22 19:24:47,303 INFO] Model is improving ppl: inf --> 20.4038.
[2019-12-22 19:24:47,303 INFO] Model is improving acc: -inf --> 22.1532.
[2019-12-22 19:24:48,514 INFO] Step 100/ 2014; acc:  28.03; ppl: 19.67; xent: 2.98; lr: 1.00000; 3998/4498 tok/s;     10 sec
[2019-12-22 19:24:48,519 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-22 19:24:48,589 INFO] number of examples: 16105
[2019-12-22 19:24:53,423 INFO] Validation perplexity: 6.27514
[2019-12-22 19:24:53,423 INFO] Validation accuracy: 38.3339
[2019-12-22 19:24:53,423 INFO] Model is improving ppl: 20.4038 --> 6.27514.
[2019-12-22 19:24:53,423 INFO] Model is improving acc: 22.1532 --> 38.3339.
[2019-12-22 19:24:54,610 INFO] Step 150/ 2014; acc:  43.48; ppl:  4.83; xent: 1.57; lr: 1.00000; 4203/4728 tok/s;     16 sec
[2019-12-22 19:24:54,610 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-22 19:24:54,943 INFO] number of examples: 16105
[2019-12-22 19:24:59,893 INFO] Validation perplexity: 3.97184
[2019-12-22 19:24:59,893 INFO] Validation accuracy: 45.3862
[2019-12-22 19:24:59,894 INFO] Model is improving ppl: 6.27514 --> 3.97184.
[2019-12-22 19:24:59,894 INFO] Model is improving acc: 38.3339 --> 45.3862.
[2019-12-22 19:25:01,105 INFO] Step 200/ 2014; acc:  44.47; ppl:  4.61; xent: 1.53; lr: 1.00000; 3941/4434 tok/s;     23 sec
[2019-12-22 19:25:01,106 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-22 19:25:01,168 INFO] number of examples: 16105
[2019-12-22 19:25:05,946 INFO] Validation perplexity: 8.91401
[2019-12-22 19:25:05,950 INFO] Validation accuracy: 45.3538
[2019-12-22 19:25:05,950 INFO] Decreasing patience: 2/3
[2019-12-22 19:25:07,147 INFO] Step 250/ 2014; acc:  47.42; ppl:  4.23; xent: 1.44; lr: 1.00000; 4164/4685 tok/s;     29 sec
[2019-12-22 19:25:07,148 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-22 19:25:07,490 INFO] number of examples: 16105
[2019-12-22 19:25:12,395 INFO] Validation perplexity: 3.76169
[2019-12-22 19:25:12,395 INFO] Validation accuracy: 51.6134
[2019-12-22 19:25:12,395 INFO] Model is improving ppl: 3.97184 --> 3.76169.
[2019-12-22 19:25:12,395 INFO] Model is improving acc: 45.3862 --> 51.6134.
[2019-12-22 19:25:13,592 INFO] Step 300/ 2014; acc:  55.52; ppl:  3.09; xent: 1.13; lr: 1.00000; 3973/4469 tok/s;     35 sec
[2019-12-22 19:25:13,592 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-22 19:25:13,655 INFO] number of examples: 16105
[2019-12-22 19:25:18,522 INFO] Validation perplexity: 2.98381
[2019-12-22 19:25:18,522 INFO] Validation accuracy: 56.2496
[2019-12-22 19:25:18,522 INFO] Model is improving ppl: 3.76169 --> 2.98381.
[2019-12-22 19:25:18,522 INFO] Model is improving acc: 51.6134 --> 56.2496.
[2019-12-22 19:25:19,725 INFO] Step 350/ 2014; acc:  55.33; ppl:  3.50; xent: 1.25; lr: 1.00000; 4174/4696 tok/s;     41 sec
[2019-12-22 19:25:19,725 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-22 19:25:19,789 INFO] number of examples: 16105
[2019-12-22 19:25:24,655 INFO] Validation perplexity: 2.3011
[2019-12-22 19:25:24,655 INFO] Validation accuracy: 67.8099
[2019-12-22 19:25:24,655 INFO] Model is improving ppl: 2.98381 --> 2.3011.
[2019-12-22 19:25:24,655 INFO] Model is improving acc: 56.2496 --> 67.8099.
[2019-12-22 19:25:25,852 INFO] Step 400/ 2014; acc:  72.40; ppl:  2.17; xent: 0.77; lr: 1.00000; 4179/4701 tok/s;     47 sec
[2019-12-22 19:25:25,852 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-22 19:25:26,173 INFO] number of examples: 16105
[2019-12-22 19:25:30,981 INFO] Validation perplexity: 1.39891
[2019-12-22 19:25:30,981 INFO] Validation accuracy: 87.7015
[2019-12-22 19:25:30,982 INFO] Model is improving ppl: 2.3011 --> 1.39891.
[2019-12-22 19:25:30,982 INFO] Model is improving acc: 67.8099 --> 87.7015.
[2019-12-22 19:25:32,174 INFO] Step 450/ 2014; acc:  90.51; ppl:  1.31; xent: 0.27; lr: 1.00000; 4049/4556 tok/s;     54 sec
[2019-12-22 19:25:32,174 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-22 19:25:32,238 INFO] number of examples: 16105
[2019-12-22 19:25:37,205 INFO] Validation perplexity: 1.28666
[2019-12-22 19:25:37,205 INFO] Validation accuracy: 91.7044
[2019-12-22 19:25:37,205 INFO] Model is improving ppl: 1.39891 --> 1.28666.
[2019-12-22 19:25:37,205 INFO] Model is improving acc: 87.7015 --> 91.7044.
[2019-12-22 19:25:38,405 INFO] Step 500/ 2014; acc:  93.49; ppl:  1.28; xent: 0.25; lr: 1.00000; 4109/4622 tok/s;     60 sec
[2019-12-22 19:25:38,405 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-22 19:25:38,730 INFO] number of examples: 16105
[2019-12-22 19:25:43,566 INFO] Validation perplexity: 1.00245
[2019-12-22 19:25:43,567 INFO] Validation accuracy: 100
[2019-12-22 19:25:43,567 INFO] Model is improving ppl: 1.28666 --> 1.00245.
[2019-12-22 19:25:43,567 INFO] Model is improving acc: 91.7044 --> 100.
[2019-12-22 19:25:44,754 INFO] Step 550/ 2014; acc: 100.00; ppl:  1.00; xent: 0.00; lr: 1.00000; 4032/4536 tok/s;     66 sec
[2019-12-22 19:25:44,754 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-22 19:25:44,819 INFO] number of examples: 16105
[2019-12-22 19:25:49,657 INFO] Validation perplexity: 1.00059
[2019-12-22 19:25:49,657 INFO] Validation accuracy: 100
[2019-12-22 19:25:49,657 INFO] Stalled patience: 2/3
[2019-12-22 19:25:50,844 INFO] Step 600/ 2014; acc: 100.00; ppl:  1.00; xent: 0.00; lr: 1.00000; 4204/4729 tok/s;     72 sec
[2019-12-22 19:25:50,844 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-22 19:25:51,176 INFO] number of examples: 16105
[2019-12-22 19:25:56,032 INFO] Validation perplexity: 1.00031
[2019-12-22 19:25:56,033 INFO] Validation accuracy: 100
[2019-12-22 19:25:56,033 INFO] Stalled patience: 1/3
[2019-12-22 19:25:57,252 INFO] Step 650/ 2014; acc: 100.00; ppl:  1.00; xent: 0.00; lr: 1.00000; 3995/4495 tok/s;     79 sec
[2019-12-22 19:25:57,252 INFO] Loading dataset from Data/SVO_AN/prepro.valid.0.pt
[2019-12-22 19:25:57,318 INFO] number of examples: 16105
[2019-12-22 19:26:02,159 INFO] Validation perplexity: 1.00021
[2019-12-22 19:26:02,159 INFO] Validation accuracy: 100
[2019-12-22 19:26:02,160 INFO] Stalled patience: 0/3
[2019-12-22 19:26:02,160 INFO] Training finished after stalled validations. Early Stop!
[2019-12-22 19:26:02,160 INFO] Best model found at step 500
[2019-12-22 19:26:02,170 INFO] Saving checkpoint Models/SVO_AN_model_step_650.pt
