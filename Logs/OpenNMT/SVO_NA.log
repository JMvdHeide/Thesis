[2019-12-26 22:05:41,120 INFO]  * src vocab size = 38
[2019-12-26 22:05:41,121 INFO]  * tgt vocab size = 42
[2019-12-26 22:05:41,121 INFO] Building model...
[2019-12-26 22:05:45,436 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(38, 500, padding_idx=1)
        )
      )
    )
    (rnn): LSTM(500, 500, num_layers=2, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(42, 500, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(1000, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=42, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-12-26 22:05:45,437 INFO] encoder: 4027000
[2019-12-26 22:05:45,437 INFO] decoder: 5800042
[2019-12-26 22:05:45,437 INFO] * number of parameters: 9827042
[2019-12-26 22:05:45,440 INFO] Starting training on GPU: [0]
[2019-12-26 22:05:45,440 INFO] Start training loop and validate every 50 steps...
[2019-12-26 22:05:45,440 INFO] Loading dataset from Data/SVO_NA/prepro.train.0.pt
[2019-12-26 22:05:46,726 INFO] number of examples: 128841
[2019-12-26 22:05:48,640 INFO] Step 50/ 1000; acc:  12.62; ppl: 555.44; xent: 6.32; lr: 1.00000; 8000/9000 tok/s;      3 sec
[2019-12-26 22:05:48,641 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-26 22:05:49,008 INFO] number of examples: 16105
[2019-12-26 22:05:54,386 INFO] Validation perplexity: 74.9664
[2019-12-26 22:05:54,386 INFO] Validation accuracy: 8.31833
[2019-12-26 22:05:54,386 INFO] Model is improving ppl: inf --> 74.9664.
[2019-12-26 22:05:54,386 INFO] Model is improving acc: -inf --> 8.31833.
[2019-12-26 22:05:55,750 INFO] Step 100/ 1000; acc:  15.32; ppl: 68.49; xent: 4.23; lr: 1.00000; 3601/4051 tok/s;     10 sec
[2019-12-26 22:05:55,750 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-26 22:05:55,825 INFO] number of examples: 16105
[2019-12-26 22:06:00,990 INFO] Validation perplexity: 11.0726
[2019-12-26 22:06:00,990 INFO] Validation accuracy: 30.3143
[2019-12-26 22:06:00,990 INFO] Model is improving ppl: 74.9664 --> 11.0726.
[2019-12-26 22:06:00,990 INFO] Model is improving acc: 8.31833 --> 30.3143.
[2019-12-26 22:06:02,348 INFO] Step 150/ 1000; acc:  29.67; ppl: 10.93; xent: 2.39; lr: 1.00000; 3880/4365 tok/s;     17 sec
[2019-12-26 22:06:02,349 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-26 22:06:02,746 INFO] number of examples: 16105
[2019-12-26 22:06:08,089 INFO] Validation perplexity: 4.90773
[2019-12-26 22:06:08,089 INFO] Validation accuracy: 38.4146
[2019-12-26 22:06:08,089 INFO] Model is improving ppl: 11.0726 --> 4.90773.
[2019-12-26 22:06:08,089 INFO] Model is improving acc: 30.3143 --> 38.4146.
[2019-12-26 22:06:09,468 INFO] Step 200/ 1000; acc:  43.03; ppl:  4.64; xent: 1.54; lr: 1.00000; 3596/4045 tok/s;     24 sec
[2019-12-26 22:06:09,468 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-26 22:06:09,532 INFO] number of examples: 16105
[2019-12-26 22:06:14,980 INFO] Validation perplexity: 4.7549
[2019-12-26 22:06:14,980 INFO] Validation accuracy: 43.3013
[2019-12-26 22:06:14,980 INFO] Model is improving ppl: 4.90773 --> 4.7549.
[2019-12-26 22:06:14,980 INFO] Model is improving acc: 38.4146 --> 43.3013.
[2019-12-26 22:06:16,317 INFO] Step 250/ 1000; acc:  46.22; ppl:  4.48; xent: 1.50; lr: 1.00000; 3738/4205 tok/s;     31 sec
[2019-12-26 22:06:16,317 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-26 22:06:16,717 INFO] number of examples: 16105
[2019-12-26 22:06:22,046 INFO] Validation perplexity: 3.2491
[2019-12-26 22:06:22,046 INFO] Validation accuracy: 57.032
[2019-12-26 22:06:22,046 INFO] Model is improving ppl: 4.7549 --> 3.2491.
[2019-12-26 22:06:22,046 INFO] Model is improving acc: 43.3013 --> 57.032.
[2019-12-26 22:06:23,436 INFO] Step 300/ 1000; acc:  53.50; ppl:  4.55; xent: 1.52; lr: 1.00000; 3596/4045 tok/s;     38 sec
[2019-12-26 22:06:23,437 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-26 22:06:23,504 INFO] number of examples: 16105
[2019-12-26 22:06:28,890 INFO] Validation perplexity: 2.73005
[2019-12-26 22:06:28,890 INFO] Validation accuracy: 66.9578
[2019-12-26 22:06:28,890 INFO] Model is improving ppl: 3.2491 --> 2.73005.
[2019-12-26 22:06:28,890 INFO] Model is improving acc: 57.032 --> 66.9578.
[2019-12-26 22:06:30,287 INFO] Step 350/ 1000; acc:  74.64; ppl:  2.15; xent: 0.76; lr: 1.00000; 3737/4204 tok/s;     45 sec
[2019-12-26 22:06:30,287 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-26 22:06:30,357 INFO] number of examples: 16105
[2019-12-26 22:06:35,527 INFO] Validation perplexity: 1.28602
[2019-12-26 22:06:35,527 INFO] Validation accuracy: 91.652
[2019-12-26 22:06:35,527 INFO] Model is improving ppl: 2.73005 --> 1.28602.
[2019-12-26 22:06:35,527 INFO] Model is improving acc: 66.9578 --> 91.652.
[2019-12-26 22:06:36,875 INFO] Step 400/ 1000; acc:  97.75; ppl:  1.08; xent: 0.07; lr: 1.00000; 3886/4371 tok/s;     51 sec
[2019-12-26 22:06:36,876 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-26 22:06:37,242 INFO] number of examples: 16105
[2019-12-26 22:06:42,436 INFO] Validation perplexity: 1.00173
[2019-12-26 22:06:42,436 INFO] Validation accuracy: 100
[2019-12-26 22:06:42,436 INFO] Model is improving ppl: 1.28602 --> 1.00173.
[2019-12-26 22:06:42,436 INFO] Model is improving acc: 91.652 --> 100.
[2019-12-26 22:06:43,786 INFO] Step 450/ 1000; acc: 100.00; ppl:  1.00; xent: 0.00; lr: 1.00000; 3705/4168 tok/s;     58 sec
[2019-12-26 22:06:43,786 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-26 22:06:43,855 INFO] number of examples: 16105
[2019-12-26 22:06:49,151 INFO] Validation perplexity: 1.00054
[2019-12-26 22:06:49,152 INFO] Validation accuracy: 100
[2019-12-26 22:06:49,152 INFO] Stalled patience: 2/3
[2019-12-26 22:06:50,502 INFO] Step 500/ 1000; acc: 100.00; ppl:  1.00; xent: 0.00; lr: 1.00000; 3812/4289 tok/s;     65 sec
[2019-12-26 22:06:50,502 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-26 22:06:50,882 INFO] number of examples: 16105
[2019-12-26 22:06:56,302 INFO] Validation perplexity: 1.0003
[2019-12-26 22:06:56,302 INFO] Validation accuracy: 100
[2019-12-26 22:06:56,302 INFO] Stalled patience: 1/3
[2019-12-26 22:06:57,682 INFO] Step 550/ 1000; acc: 100.00; ppl:  1.00; xent: 0.00; lr: 1.00000; 3566/4011 tok/s;     72 sec
[2019-12-26 22:06:57,682 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-26 22:06:57,751 INFO] number of examples: 16105
[2019-12-26 22:07:02,987 INFO] Validation perplexity: 1.0002
[2019-12-26 22:07:02,988 INFO] Validation accuracy: 100
[2019-12-26 22:07:02,988 INFO] Stalled patience: 0/3
[2019-12-26 22:07:02,988 INFO] Training finished after stalled validations. Early Stop!
[2019-12-26 22:07:02,988 INFO] Best model found at step 400
[2019-12-26 22:07:02,999 INFO] Saving checkpoint Models/SVO_NA_model_step_550.pt
