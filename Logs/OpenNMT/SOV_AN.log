[2019-12-26 22:07:05,217 INFO]  * src vocab size = 38
[2019-12-26 22:07:05,219 INFO]  * tgt vocab size = 42
[2019-12-26 22:07:05,219 INFO] Building model...
[2019-12-26 22:07:09,567 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(38, 500, padding_idx=1)
        )
      )
    )
    (rnn): LSTM(500, 500, num_layers=2, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(42, 500, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(1000, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=42, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-12-26 22:07:09,567 INFO] encoder: 4027000
[2019-12-26 22:07:09,568 INFO] decoder: 5800042
[2019-12-26 22:07:09,568 INFO] * number of parameters: 9827042
[2019-12-26 22:07:09,571 INFO] Starting training on GPU: [0]
[2019-12-26 22:07:09,571 INFO] Start training loop and validate every 50 steps...
[2019-12-26 22:07:09,572 INFO] Loading dataset from Data/SOV_AN/prepro.train.0.pt
[2019-12-26 22:07:10,831 INFO] number of examples: 128841
[2019-12-26 22:07:12,687 INFO] Step 50/ 1000; acc:  13.54; ppl: 102.76; xent: 4.63; lr: 1.00000; 8217/9244 tok/s;      3 sec
[2019-12-26 22:07:12,688 INFO] Loading dataset from Data/SOV_AN/prepro.valid.0.pt
[2019-12-26 22:07:13,161 INFO] number of examples: 16105
[2019-12-26 22:07:18,369 INFO] Validation perplexity: 370.95
[2019-12-26 22:07:18,369 INFO] Validation accuracy: 19.1852
[2019-12-26 22:07:18,369 INFO] Model is improving ppl: inf --> 370.95.
[2019-12-26 22:07:18,369 INFO] Model is improving acc: -inf --> 19.1852.
[2019-12-26 22:07:19,705 INFO] Step 100/ 1000; acc:  28.27; ppl: 20.25; xent: 3.01; lr: 1.00000; 3648/4104 tok/s;     10 sec
[2019-12-26 22:07:19,705 INFO] Loading dataset from Data/SOV_AN/prepro.valid.0.pt
[2019-12-26 22:07:19,782 INFO] number of examples: 16105
[2019-12-26 22:07:25,053 INFO] Validation perplexity: 6.48206
[2019-12-26 22:07:25,053 INFO] Validation accuracy: 42.9542
[2019-12-26 22:07:25,053 INFO] Model is improving ppl: 370.95 --> 6.48206.
[2019-12-26 22:07:25,053 INFO] Model is improving acc: 19.1852 --> 42.9542.
[2019-12-26 22:07:26,385 INFO] Step 150/ 1000; acc:  43.21; ppl:  4.72; xent: 1.55; lr: 1.00000; 3832/4311 tok/s;     17 sec
[2019-12-26 22:07:26,385 INFO] Loading dataset from Data/SOV_AN/prepro.valid.0.pt
[2019-12-26 22:07:26,757 INFO] number of examples: 16105
[2019-12-26 22:07:31,982 INFO] Validation perplexity: 4.03356
[2019-12-26 22:07:31,982 INFO] Validation accuracy: 45.429
[2019-12-26 22:07:31,982 INFO] Model is improving ppl: 6.48206 --> 4.03356.
[2019-12-26 22:07:31,982 INFO] Model is improving acc: 42.9542 --> 45.429.
[2019-12-26 22:07:33,282 INFO] Step 200/ 1000; acc:  45.61; ppl:  4.32; xent: 1.46; lr: 1.00000; 3712/4176 tok/s;     24 sec
[2019-12-26 22:07:33,283 INFO] Loading dataset from Data/SOV_AN/prepro.valid.0.pt
[2019-12-26 22:07:33,348 INFO] number of examples: 16105
[2019-12-26 22:07:38,542 INFO] Validation perplexity: 3.83217
[2019-12-26 22:07:38,542 INFO] Validation accuracy: 49.1186
[2019-12-26 22:07:38,542 INFO] Model is improving ppl: 4.03356 --> 3.83217.
[2019-12-26 22:07:38,542 INFO] Model is improving acc: 45.429 --> 49.1186.
[2019-12-26 22:07:39,887 INFO] Step 250/ 1000; acc:  47.98; ppl:  5.20; xent: 1.65; lr: 1.00000; 3876/4361 tok/s;     30 sec
[2019-12-26 22:07:39,888 INFO] Loading dataset from Data/SOV_AN/prepro.valid.0.pt
[2019-12-26 22:07:40,284 INFO] number of examples: 16105
[2019-12-26 22:07:45,470 INFO] Validation perplexity: 3.74361
[2019-12-26 22:07:45,470 INFO] Validation accuracy: 52.4978
[2019-12-26 22:07:45,470 INFO] Model is improving ppl: 3.83217 --> 3.74361.
[2019-12-26 22:07:45,471 INFO] Model is improving acc: 49.1186 --> 52.4978.
[2019-12-26 22:07:46,779 INFO] Step 300/ 1000; acc:  65.74; ppl:  2.38; xent: 0.87; lr: 1.00000; 3715/4179 tok/s;     37 sec
[2019-12-26 22:07:46,780 INFO] Loading dataset from Data/SOV_AN/prepro.valid.0.pt
[2019-12-26 22:07:46,846 INFO] number of examples: 16105
[2019-12-26 22:07:52,062 INFO] Validation perplexity: 2.98886
[2019-12-26 22:07:52,062 INFO] Validation accuracy: 64.294
[2019-12-26 22:07:52,062 INFO] Model is improving ppl: 3.74361 --> 2.98886.
[2019-12-26 22:07:52,062 INFO] Model is improving acc: 52.4978 --> 64.294.
[2019-12-26 22:07:53,362 INFO] Step 350/ 1000; acc:  84.36; ppl:  1.59; xent: 0.46; lr: 1.00000; 3889/4375 tok/s;     44 sec
[2019-12-26 22:07:53,363 INFO] Loading dataset from Data/SOV_AN/prepro.valid.0.pt
[2019-12-26 22:07:53,428 INFO] number of examples: 16105
[2019-12-26 22:07:58,583 INFO] Validation perplexity: 1.00554
[2019-12-26 22:07:58,584 INFO] Validation accuracy: 100
[2019-12-26 22:07:58,584 INFO] Model is improving ppl: 2.98886 --> 1.00554.
[2019-12-26 22:07:58,584 INFO] Model is improving acc: 64.294 --> 100.
[2019-12-26 22:07:59,892 INFO] Step 400/ 1000; acc: 100.00; ppl:  1.00; xent: 0.00; lr: 1.00000; 3921/4411 tok/s;     50 sec
[2019-12-26 22:07:59,893 INFO] Loading dataset from Data/SOV_AN/prepro.valid.0.pt
[2019-12-26 22:08:00,266 INFO] number of examples: 16105
[2019-12-26 22:08:05,423 INFO] Validation perplexity: 1.00068
[2019-12-26 22:08:05,424 INFO] Validation accuracy: 100
[2019-12-26 22:08:05,424 INFO] Stalled patience: 2/3
[2019-12-26 22:08:06,706 INFO] Step 450/ 1000; acc: 100.00; ppl:  1.00; xent: 0.00; lr: 1.00000; 3758/4227 tok/s;     57 sec
[2019-12-26 22:08:06,706 INFO] Loading dataset from Data/SOV_AN/prepro.valid.0.pt
[2019-12-26 22:08:06,771 INFO] number of examples: 16105
[2019-12-26 22:08:12,006 INFO] Validation perplexity: 1.00032
[2019-12-26 22:08:12,006 INFO] Validation accuracy: 100
[2019-12-26 22:08:12,006 INFO] Stalled patience: 1/3
[2019-12-26 22:08:13,367 INFO] Step 500/ 1000; acc: 100.00; ppl:  1.00; xent: 0.00; lr: 1.00000; 3843/4324 tok/s;     64 sec
[2019-12-26 22:08:13,367 INFO] Loading dataset from Data/SOV_AN/prepro.valid.0.pt
[2019-12-26 22:08:13,733 INFO] number of examples: 16105
[2019-12-26 22:08:18,866 INFO] Validation perplexity: 1.0002
[2019-12-26 22:08:18,867 INFO] Validation accuracy: 100
[2019-12-26 22:08:18,867 INFO] Stalled patience: 0/3
[2019-12-26 22:08:18,867 INFO] Training finished after stalled validations. Early Stop!
[2019-12-26 22:08:18,867 INFO] Best model found at step 350
[2019-12-26 22:08:18,878 INFO] Saving checkpoint Models/SOV_AN_model_step_500.pt
