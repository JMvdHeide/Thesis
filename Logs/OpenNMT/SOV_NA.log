[2019-12-26 22:08:21,354 INFO]  * src vocab size = 38
[2019-12-26 22:08:21,356 INFO]  * tgt vocab size = 42
[2019-12-26 22:08:21,356 INFO] Building model...
[2019-12-26 22:08:25,646 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(38, 500, padding_idx=1)
        )
      )
    )
    (rnn): LSTM(500, 500, num_layers=2, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(42, 500, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(1000, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=42, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-12-26 22:08:25,646 INFO] encoder: 4027000
[2019-12-26 22:08:25,647 INFO] decoder: 5800042
[2019-12-26 22:08:25,647 INFO] * number of parameters: 9827042
[2019-12-26 22:08:25,650 INFO] Starting training on GPU: [0]
[2019-12-26 22:08:25,650 INFO] Start training loop and validate every 50 steps...
[2019-12-26 22:08:25,650 INFO] Loading dataset from Data/SOV_NA/prepro.train.0.pt
[2019-12-26 22:08:26,879 INFO] number of examples: 128841
[2019-12-26 22:08:28,750 INFO] Step 50/ 1000; acc:  12.91; ppl: 186.30; xent: 5.23; lr: 1.00000; 8260/9293 tok/s;      3 sec
[2019-12-26 22:08:28,750 INFO] Loading dataset from Data/SOV_NA/prepro.valid.0.pt
[2019-12-26 22:08:29,134 INFO] number of examples: 16105
[2019-12-26 22:08:34,405 INFO] Validation perplexity: 242.426
[2019-12-26 22:08:34,405 INFO] Validation accuracy: 2.75139
[2019-12-26 22:08:34,406 INFO] Model is improving ppl: inf --> 242.426.
[2019-12-26 22:08:34,406 INFO] Model is improving acc: -inf --> 2.75139.
[2019-12-26 22:08:35,727 INFO] Step 100/ 1000; acc:  18.64; ppl: 44.08; xent: 3.79; lr: 1.00000; 3669/4128 tok/s;     10 sec
[2019-12-26 22:08:35,728 INFO] Loading dataset from Data/SOV_NA/prepro.valid.0.pt
[2019-12-26 22:08:35,806 INFO] number of examples: 16105
[2019-12-26 22:08:41,070 INFO] Validation perplexity: 11.7109
[2019-12-26 22:08:41,070 INFO] Validation accuracy: 20.2028
[2019-12-26 22:08:41,070 INFO] Model is improving ppl: 242.426 --> 11.7109.
[2019-12-26 22:08:41,070 INFO] Model is improving acc: 2.75139 --> 20.2028.
[2019-12-26 22:08:42,395 INFO] Step 150/ 1000; acc:  38.31; ppl:  6.98; xent: 1.94; lr: 1.00000; 3840/4320 tok/s;     17 sec
[2019-12-26 22:08:42,395 INFO] Loading dataset from Data/SOV_NA/prepro.valid.0.pt
[2019-12-26 22:08:42,785 INFO] number of examples: 16105
[2019-12-26 22:08:48,143 INFO] Validation perplexity: 4.2061
[2019-12-26 22:08:48,143 INFO] Validation accuracy: 45.4248
[2019-12-26 22:08:48,143 INFO] Model is improving ppl: 11.7109 --> 4.2061.
[2019-12-26 22:08:48,143 INFO] Model is improving acc: 20.2028 --> 45.4248.
[2019-12-26 22:08:49,472 INFO] Step 200/ 1000; acc:  44.45; ppl:  4.64; xent: 1.53; lr: 1.00000; 3617/4069 tok/s;     24 sec
[2019-12-26 22:08:49,473 INFO] Loading dataset from Data/SOV_NA/prepro.valid.0.pt
[2019-12-26 22:08:49,540 INFO] number of examples: 16105
[2019-12-26 22:08:54,780 INFO] Validation perplexity: 4.29086
[2019-12-26 22:08:54,780 INFO] Validation accuracy: 35.6045
[2019-12-26 22:08:54,780 INFO] Decreasing patience: 2/3
[2019-12-26 22:08:56,192 INFO] Step 250/ 1000; acc:  48.91; ppl:  4.56; xent: 1.52; lr: 1.00000; 3810/4286 tok/s;     31 sec
[2019-12-26 22:08:56,192 INFO] Loading dataset from Data/SOV_NA/prepro.valid.0.pt
[2019-12-26 22:08:56,569 INFO] number of examples: 16105
[2019-12-26 22:09:01,620 INFO] Validation perplexity: 5.23848
[2019-12-26 22:09:01,620 INFO] Validation accuracy: 54.4413
[2019-12-26 22:09:01,620 INFO] Stalled patience: 2/3
[2019-12-26 22:09:02,875 INFO] Step 300/ 1000; acc:  67.72; ppl:  2.81; xent: 1.03; lr: 1.00000; 3831/4310 tok/s;     37 sec
[2019-12-26 22:09:02,875 INFO] Loading dataset from Data/SOV_NA/prepro.valid.0.pt
[2019-12-26 22:09:02,939 INFO] number of examples: 16105
[2019-12-26 22:09:08,000 INFO] Validation perplexity: 3.06683
[2019-12-26 22:09:08,000 INFO] Validation accuracy: 67.5491
[2019-12-26 22:09:08,000 INFO] Model is improving ppl: 4.2061 --> 3.06683.
[2019-12-26 22:09:08,000 INFO] Model is improving acc: 45.4248 --> 67.5491.
[2019-12-26 22:09:09,280 INFO] Step 350/ 1000; acc:  86.39; ppl:  1.57; xent: 0.45; lr: 1.00000; 3997/4496 tok/s;     44 sec
[2019-12-26 22:09:09,281 INFO] Loading dataset from Data/SOV_NA/prepro.valid.0.pt
[2019-12-26 22:09:09,346 INFO] number of examples: 16105
[2019-12-26 22:09:14,526 INFO] Validation perplexity: 1.07635
[2019-12-26 22:09:14,526 INFO] Validation accuracy: 97.982
[2019-12-26 22:09:14,526 INFO] Model is improving ppl: 3.06683 --> 1.07635.
[2019-12-26 22:09:14,526 INFO] Model is improving acc: 67.5491 --> 97.982.
[2019-12-26 22:09:15,837 INFO] Step 400/ 1000; acc:  99.81; ppl:  1.01; xent: 0.01; lr: 1.00000; 3905/4393 tok/s;     50 sec
[2019-12-26 22:09:15,838 INFO] Loading dataset from Data/SOV_NA/prepro.valid.0.pt
[2019-12-26 22:09:16,200 INFO] number of examples: 16105
[2019-12-26 22:09:21,367 INFO] Validation perplexity: 1.00076
[2019-12-26 22:09:21,367 INFO] Validation accuracy: 100
[2019-12-26 22:09:21,367 INFO] Model is improving ppl: 1.07635 --> 1.00076.
[2019-12-26 22:09:21,367 INFO] Model is improving acc: 97.982 --> 100.
[2019-12-26 22:09:22,655 INFO] Step 450/ 1000; acc: 100.00; ppl:  1.00; xent: 0.00; lr: 1.00000; 3755/4224 tok/s;     57 sec
[2019-12-26 22:09:22,656 INFO] Loading dataset from Data/SOV_NA/prepro.valid.0.pt
[2019-12-26 22:09:22,722 INFO] number of examples: 16105
[2019-12-26 22:09:27,828 INFO] Validation perplexity: 1.0003
[2019-12-26 22:09:27,828 INFO] Validation accuracy: 100
[2019-12-26 22:09:27,828 INFO] Stalled patience: 2/3
[2019-12-26 22:09:29,144 INFO] Step 500/ 1000; acc: 100.00; ppl:  1.00; xent: 0.00; lr: 1.00000; 3945/4438 tok/s;     63 sec
[2019-12-26 22:09:29,145 INFO] Loading dataset from Data/SOV_NA/prepro.valid.0.pt
[2019-12-26 22:09:29,519 INFO] number of examples: 16105
[2019-12-26 22:09:34,600 INFO] Validation perplexity: 1.00018
[2019-12-26 22:09:34,600 INFO] Validation accuracy: 100
[2019-12-26 22:09:34,600 INFO] Stalled patience: 1/3
[2019-12-26 22:09:35,916 INFO] Step 550/ 1000; acc: 100.00; ppl:  1.00; xent: 0.00; lr: 1.00000; 3781/4253 tok/s;     70 sec
[2019-12-26 22:09:35,916 INFO] Loading dataset from Data/SOV_NA/prepro.valid.0.pt
[2019-12-26 22:09:35,984 INFO] number of examples: 16105
[2019-12-26 22:09:41,594 INFO] Validation perplexity: 1.00013
[2019-12-26 22:09:41,594 INFO] Validation accuracy: 100
[2019-12-26 22:09:41,594 INFO] Stalled patience: 0/3
[2019-12-26 22:09:41,594 INFO] Training finished after stalled validations. Early Stop!
[2019-12-26 22:09:41,594 INFO] Best model found at step 400
[2019-12-26 22:09:41,605 INFO] Saving checkpoint Models/SOV_NA_model_step_550.pt
