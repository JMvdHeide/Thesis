[2019-12-22 19:26:04,237 INFO]  * src vocab size = 38
[2019-12-22 19:26:04,239 INFO]  * tgt vocab size = 42
[2019-12-22 19:26:04,239 INFO] Building model...
[2019-12-22 19:26:08,470 INFO] NMTModel(
  (encoder): RNNEncoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(38, 500, padding_idx=1)
        )
      )
    )
    (rnn): LSTM(500, 500, num_layers=2, dropout=0.3)
  )
  (decoder): InputFeedRNNDecoder(
    (embeddings): Embeddings(
      (make_embedding): Sequential(
        (emb_luts): Elementwise(
          (0): Embedding(42, 500, padding_idx=1)
        )
      )
    )
    (dropout): Dropout(p=0.3, inplace=False)
    (rnn): StackedLSTM(
      (dropout): Dropout(p=0.3, inplace=False)
      (layers): ModuleList(
        (0): LSTMCell(1000, 500)
        (1): LSTMCell(500, 500)
      )
    )
    (attn): GlobalAttention(
      (linear_in): Linear(in_features=500, out_features=500, bias=False)
      (linear_out): Linear(in_features=1000, out_features=500, bias=False)
    )
  )
  (generator): Sequential(
    (0): Linear(in_features=500, out_features=42, bias=True)
    (1): Cast()
    (2): LogSoftmax()
  )
)
[2019-12-22 19:26:08,471 INFO] encoder: 4027000
[2019-12-22 19:26:08,471 INFO] decoder: 5800042
[2019-12-22 19:26:08,471 INFO] * number of parameters: 9827042
[2019-12-22 19:26:08,475 INFO] Starting training on GPU: [0]
[2019-12-22 19:26:08,475 INFO] Start training loop and validate every 50 steps...
[2019-12-22 19:26:08,476 INFO] Loading dataset from Data/SVO_NA/prepro.train.0.pt
[2019-12-22 19:26:09,449 INFO] number of examples: 128841
[2019-12-22 19:26:11,118 INFO] Step 50/ 2014; acc:  12.24; ppl: 310.15; xent: 5.74; lr: 1.00000; 9689/10900 tok/s;      3 sec
[2019-12-22 19:26:11,118 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-22 19:26:11,419 INFO] number of examples: 16105
[2019-12-22 19:26:16,271 INFO] Validation perplexity: 60.9876
[2019-12-22 19:26:16,271 INFO] Validation accuracy: 20.2235
[2019-12-22 19:26:16,271 INFO] Model is improving ppl: inf --> 60.9876.
[2019-12-22 19:26:16,271 INFO] Model is improving acc: -inf --> 20.2235.
[2019-12-22 19:26:17,486 INFO] Step 100/ 2014; acc:  21.54; ppl: 38.91; xent: 3.66; lr: 1.00000; 4020/4523 tok/s;      9 sec
[2019-12-22 19:26:17,486 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-22 19:26:17,557 INFO] number of examples: 16105
[2019-12-22 19:26:22,425 INFO] Validation perplexity: 10.7704
[2019-12-22 19:26:22,425 INFO] Validation accuracy: 37.4404
[2019-12-22 19:26:22,425 INFO] Model is improving ppl: 60.9876 --> 10.7704.
[2019-12-22 19:26:22,425 INFO] Model is improving acc: 20.2235 --> 37.4404.
[2019-12-22 19:26:23,628 INFO] Step 150/ 2014; acc:  40.20; ppl:  6.10; xent: 1.81; lr: 1.00000; 4168/4689 tok/s;     15 sec
[2019-12-22 19:26:23,628 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-22 19:26:23,976 INFO] number of examples: 16105
[2019-12-22 19:26:28,953 INFO] Validation perplexity: 4.40639
[2019-12-22 19:26:28,954 INFO] Validation accuracy: 44.4058
[2019-12-22 19:26:28,954 INFO] Model is improving ppl: 10.7704 --> 4.40639.
[2019-12-22 19:26:28,954 INFO] Model is improving acc: 37.4404 --> 44.4058.
[2019-12-22 19:26:30,171 INFO] Step 200/ 2014; acc:  44.65; ppl:  4.42; xent: 1.49; lr: 1.00000; 3913/4402 tok/s;     22 sec
[2019-12-22 19:26:30,171 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-22 19:26:30,234 INFO] number of examples: 16105
[2019-12-22 19:26:35,056 INFO] Validation perplexity: 3.86109
[2019-12-22 19:26:35,059 INFO] Validation accuracy: 49.7913
[2019-12-22 19:26:35,059 INFO] Model is improving ppl: 4.40639 --> 3.86109.
[2019-12-22 19:26:35,059 INFO] Model is improving acc: 44.4058 --> 49.7913.
[2019-12-22 19:26:36,244 INFO] Step 250/ 2014; acc:  48.01; ppl:  4.21; xent: 1.44; lr: 1.00000; 4215/4742 tok/s;     28 sec
[2019-12-22 19:26:36,245 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-22 19:26:36,603 INFO] number of examples: 16105
[2019-12-22 19:26:41,421 INFO] Validation perplexity: 5.16206
[2019-12-22 19:26:41,421 INFO] Validation accuracy: 48.25
[2019-12-22 19:26:41,421 INFO] Decreasing patience: 2/3
[2019-12-22 19:26:42,623 INFO] Step 300/ 2014; acc:  64.07; ppl:  3.14; xent: 1.14; lr: 1.00000; 4013/4515 tok/s;     34 sec
[2019-12-22 19:26:42,624 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-22 19:26:42,686 INFO] number of examples: 16105
[2019-12-22 19:26:47,502 INFO] Validation perplexity: 1.92162
[2019-12-22 19:26:47,503 INFO] Validation accuracy: 79.0783
[2019-12-22 19:26:47,503 INFO] Model is improving ppl: 3.86109 --> 1.92162.
[2019-12-22 19:26:47,503 INFO] Model is improving acc: 49.7913 --> 79.0783.
[2019-12-22 19:26:48,692 INFO] Step 350/ 2014; acc:  95.74; ppl:  1.17; xent: 0.16; lr: 1.00000; 4219/4746 tok/s;     40 sec
[2019-12-22 19:26:48,692 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-22 19:26:48,755 INFO] number of examples: 16105
[2019-12-22 19:26:53,571 INFO] Validation perplexity: 1.00215
[2019-12-22 19:26:53,571 INFO] Validation accuracy: 100
[2019-12-22 19:26:53,571 INFO] Model is improving ppl: 1.92162 --> 1.00215.
[2019-12-22 19:26:53,571 INFO] Model is improving acc: 79.0783 --> 100.
[2019-12-22 19:26:54,764 INFO] Step 400/ 2014; acc: 100.00; ppl:  1.00; xent: 0.00; lr: 1.00000; 4216/4743 tok/s;     46 sec
[2019-12-22 19:26:54,766 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-22 19:26:55,109 INFO] number of examples: 16105
[2019-12-22 19:26:59,924 INFO] Validation perplexity: 1.00064
[2019-12-22 19:26:59,924 INFO] Validation accuracy: 100
[2019-12-22 19:26:59,925 INFO] Stalled patience: 2/3
[2019-12-22 19:27:01,109 INFO] Step 450/ 2014; acc: 100.00; ppl:  1.00; xent: 0.00; lr: 1.00000; 4036/4540 tok/s;     53 sec
[2019-12-22 19:27:01,109 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-22 19:27:01,173 INFO] number of examples: 16105
[2019-12-22 19:27:05,994 INFO] Validation perplexity: 1.00035
[2019-12-22 19:27:05,994 INFO] Validation accuracy: 100
[2019-12-22 19:27:05,994 INFO] Stalled patience: 1/3
[2019-12-22 19:27:07,185 INFO] Step 500/ 2014; acc: 100.00; ppl:  1.00; xent: 0.00; lr: 1.00000; 4214/4740 tok/s;     59 sec
[2019-12-22 19:27:07,185 INFO] Loading dataset from Data/SVO_NA/prepro.valid.0.pt
[2019-12-22 19:27:07,525 INFO] number of examples: 16105
[2019-12-22 19:27:12,341 INFO] Validation perplexity: 1.00024
[2019-12-22 19:27:12,341 INFO] Validation accuracy: 100
[2019-12-22 19:27:12,341 INFO] Stalled patience: 0/3
[2019-12-22 19:27:12,341 INFO] Training finished after stalled validations. Early Stop!
[2019-12-22 19:27:12,341 INFO] Best model found at step 350
[2019-12-22 19:27:12,352 INFO] Saving checkpoint Models/SVO_NA_model_step_500.pt
